# -*- coding: utf-8 -*-
"""Copy of Gen AI-11b.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wnwVEQXmqNh55C5TXVZ1Vw4nzbdRo-zU
"""

!pip install -q sentence-transformers faiss-cpu

from sentence_transformers import SentenceTransformer
import faiss

#step1:
docs = [
    "The Taj Mahal is located in Agra",
    "The Great Wall of China is found in China",
    "The Eiffel Tower is located in Paris"
]

#step2:create embedding
model = SentenceTransformer('all-MiniLM-L6-v2')
doc_embeddings = model.encode(docs)

#step3:
dimension = doc_embeddings.shape[1]
index = faiss.IndexFlatL2(dimension)
index.add(doc_embeddings)

#step4:define retrival function
def retrieve(query, top_k=2):
  query_embedding = model.encode([query])
  distances, indices = index.search(query_embedding, top_k)
  return [docs[i] for i in indices[0]]

#step5:Ask questions
query = "where is the Taj Mahal located?"
results = retrieve(query)
print("Question:",query)
print("Retrieved Documents:")
for result in results:
  print(result)